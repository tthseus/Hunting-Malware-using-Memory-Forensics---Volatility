# Hunting-Malware-using-Memory-Forensics---Volatility
# Structure

- Introduction
- What/Why Memory Forensics
- Steps in memory forensics
- Volatility overview
- Test cases

### What/Why Memory Forensics

- Involves findings & extracting forensics artifacts from the computer's RAM
- Memory stores valuable information about the runtime state of the system or application
- Help determine which applications are running on the system, active network connections, loaded modules, kernel drivers, etc...
- Some malware samples may not write components to disk (only in memory)

Cuz in most cases, we will not have access to the malware sample during incident response. So u may acquire the memory image of the suspect system, to perform memory forensics to confirm the infection and to find the malicious artifacts.

We can use memory forensics to gain additional information about the behavior of the malware post-infection. Besides, we can execute the malware sample in an isolated environment and then acquire the infected computer memory and examine the image to get an idea of the malware's behavior after infection. 

### Steps in memory forensics

- Memory acquisition: Dumping the memory of a target machine to disk
- Memory analysis: Analyzing the memory dump for forensic artifacts

### Acquisition tools:

- [DumpIt](https://my.comae.com/login) (free)
- FTK Imager (free)
- Belkasoft RAM capturer (free)
- Memoryze FireEye (free)
- WinPmem (opensource) â€“ [Rekall](https://github.com/google/rekall) Memory forensics framework
- Volexity (commercial)
- On VMs: Suspend VM (file .vmem)

### Six-step Investigative Methodology

1. Identify rouge processes
2. Analyze process DLLs and handles
3. Review network artifacts
4. Look for evidence of code injection
5. Check for signs of a rootkits
6. Dump suspicious processes and drivers

src: SANS poster

### Volatility Overview

- Opensource advanced memory forensics framework written in Python
- Allows you to analyze and extract digital artifacts from the memory image
- Runs on various platforms (Windows, MacOS and Linux )
- Supports analysis of memory from 32-bit and 64-bit versions of Windows, MacOS, and Linux
- Consists of various plugins to extract different type of information from the memory image

Refs:

1. [Investigating Malware Using Memory Forensics - A Practical Approach - Blackhat](https://www.youtube.com/watch?v=BMFCdAGxVN4)
2. [https://github.com/volatilityfoundation/volatility/wiki/Memory-Samples](https://github.com/volatilityfoundation/volatility/wiki/Memory-Samples)
3. [https://i.blackhat.com/asia-19/Thu-March-28/bh-asia-Monappa-Investigating-Malware-Using-Memory-Forensics.pdf](https://i.blackhat.com/asia-19/Thu-March-28/bh-asia-Monappa-Investigating-Malware-Using-Memory-Forensics.pdf)
4. [https://digital-forensics.sans.org/media/Poster_Memory_Forensics.pdf](https://digital-forensics.sans.org/media/Poster_Memory_Forensics.pdf)
5. Learning Malware Analysis book- Monnappa
6. [https://digital-forensics.sans.org/media/volatility-memory-forensics-cheat-sheet.pdf](https://digital-forensics.sans.org/media/volatility-memory-forensics-cheat-sheet.pdf)
